<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NCC Command Console Dashboard</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #0f2027 0%, #2c5364 100%);
      color: #00ffe7;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: row;
      overflow-x: hidden;
    }
    .sidebar {
      width: 220px;
      background: #181a20;
      border-right: 2px solid #00ffe733;
      min-height: 100vh;
      padding: 32px 0 0 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: fixed;
      left: 0;
      top: 0;
      z-index: 10;
    }
    .sidebar h2 {
      color: #00ffe7;
      margin-bottom: 32px;
      font-size: 1.3em;
      letter-spacing: 1px;
    }
    .nav {
      display: flex;
      flex-direction: column;
      gap: 18px;
      width: 100%;
      align-items: center;
    }
    .nav button {
      background: none;
      border: none;
      color: #00ffe7;
      font-size: 1.08em;
      padding: 10px 0;
      width: 90%;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    .nav button.active, .nav button:hover {
      background: #00ffe722;
      color: #fff;
    }
    .main {
      margin-left: 220px;
      flex: 1;
      padding: 40px 36px 32px 36px;
      background: rgba(34,36,42,0.7);
      border-radius: 18px;
      box-shadow: 0 8px 32px 0 #00ffe755, 0 1.5px 8px #00ffe733;
      min-height: 100vh;
      position: relative;
    }
    .alerts {
      position: absolute;
      top: 24px;
      right: 36px;
      background: #ff3b3b;
      color: #fff;
      padding: 10px 18px;
      border-radius: 8px;
      box-shadow: 0 2px 12px #ff3b3b55;
      font-size: 1em;
      display: none;
      z-index: 100;
    }
    .timeline {
      margin-top: 32px;
      background: #23252c;
      border-radius: 10px;
      padding: 18px;
      color: #fff;
      font-size: 1.08em;
      min-height: 80px;
      box-shadow: 0 1.5px 8px #00ffe733;
      border: 1.5px solid #00ffe722;
    }
    @media (max-width: 900px) {
      .sidebar { width: 60px; }
      .sidebar h2 { display: none; }
      .nav button { font-size: 0.9em; padding: 8px 0; }
      .main { margin-left: 60px; padding: 18px 6vw 18px 6vw; }
    }
  </style>
  <script>
    // Cache-busting version string
    const NCC_VERSION = Date.now();
    window.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('img[src], source[src], video[src], audio[src]').forEach(el => {
        if (!el.src.includes('?v=')) el.src += (el.src.includes('?') ? '&' : '?') + 'v=' + NCC_VERSION;
      });
      document.querySelectorAll('link[rel="stylesheet"][href]').forEach(el => {
        if (!el.href.includes('?v=')) el.href += (el.href.includes('?') ? '&' : '?') + 'v=' + NCC_VERSION;
      });
      document.querySelectorAll('script[src]').forEach(el => {
        if (!el.src.includes('?v=') && !el.src.includes('NCC_VERSION')) el.src += (el.src.includes('?') ? '&' : '?') + 'v=' + NCC_VERSION;
      });
    });
  </script>
</head>
<body>
  <div class="sidebar">
    <h2>NCC Console</h2>
    <div style="margin-bottom:32px;width:100%;display:flex;flex-direction:column;align-items:center;">
      <div id="avatar-status" style="position:relative;width:80px;height:110px;">
        <svg id="az-svg-avatar" width="80" height="110" viewBox="0 0 80 110">
          <ellipse cx="40" cy="100" rx="32" ry="14" fill="#1a2a3a" />
          <ellipse cx="40" cy="54" rx="28" ry="34" fill="#00ffe7" stroke="#00bfae" stroke-width="2" />
          <ellipse cx="30" cy="54" rx="4" ry="6" fill="#222" />
          <ellipse cx="50" cy="54" rx="4" ry="6" fill="#222" />
          <ellipse id="az-svg-mouth" cx="40" cy="74" rx="8" ry="3" fill="#181a20" />
        </svg>
        <div id="avatar-indicator" style="position:absolute;top:6px;right:6px;width:16px;height:16px;border-radius:50%;background:#00ffe7;box-shadow:0 0 8px #00ffe7cc;"></div>
      </div>
      <div style="margin-top:12px;width:100%;">
        <label for="persona-select" style="font-size:1em;color:#00ffe7;">Persona:</label>
        <select id="persona-select" style="width:90%;margin-top:4px;padding:4px 8px;border-radius:6px;">
          <option value="azprime">AZ PRIME</option>
          <option value="emp">EMP (Media)</option>
          <option value="copilot">Copilot</option>
          <option value="chatgpt">ChatGPT</option>
        </select>
      </div>
    </div>
    <div class="nav">
      <button class="active">Dashboard</button>
      <button>Timeline</button>
      <button>Alerts</button>
      <button>Settings</button>
    </div>
  </div>
  <div class="main">
    <div class="alerts" id="alerts-area">No current alerts.</div>
    <h1>NCC Command Console Dashboard</h1>
    <div id="onboarding-tip" style="background:#00ffe7; color:#181a20; border-radius:10px; padding:12px 18px; margin-bottom:18px; font-size:1.08em; font-weight:500; box-shadow:0 2px 12px #00ffe733;max-width:600px;">
      Welcome! Use the persona selector to command AZ PRIME or other assistants. Integrations, analytics, and plugin support are now available. Hover over any section for help.<br>
      <b>Say "Hey AZ" to activate voice assistant.</b>
    </div>
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:18px;">
      <input type="text" id="az-input" placeholder="Speak or type a command..." style="flex:1;font-size:1.1em;padding:8px 12px;border-radius:8px;border:1.5px solid #00ffe7;outline:none;" autocomplete="off" />
      <button onclick="sendToAZ()" style="font-size:1.1em;padding:8px 18px;border-radius:8px;background:linear-gradient(90deg,#00ffe7 0%,#00bfae 100%);color:#181a20;font-weight:600;border:none;">Send</button>
      <button id="voice-btn" onclick="toggleVoice()" style="font-size:1.1em;padding:8px 18px;border-radius:8px;background:#181a20;color:#00ffe7;font-weight:600;border:2px solid #00ffe7;margin-left:8px;" title="Start/Stop Voice Input">ðŸŽ¤ Start Listening</button>
    </div>
    <div class="timeline" id="timeline-area">No recent events.</div>
    <!-- More advanced features will be added here in next steps -->
    <script>
      // Simple avatar animation (blink)
      setInterval(() => {
        const eyes = document.querySelectorAll('#az-svg-avatar ellipse[cx="30"], #az-svg-avatar ellipse[cx="50"]');
        eyes.forEach(e => e.setAttribute('ry', Math.random() < 0.1 ? 1 : 6));
      }, 200);
      // Avatar status indicator (active/listening/idle)
      function setAvatarStatus(status) {
        const indicator = document.getElementById('avatar-indicator');
        if (!indicator) return;
        if (status === 'listening') {
          indicator.style.background = '#00ff41';
          indicator.style.boxShadow = '0 0 12px #00ff41cc';
        } else if (status === 'idle') {
          indicator.style.background = '#ffb300';
          indicator.style.boxShadow = '0 0 8px #ffb300cc';
        } else {
          indicator.style.background = '#00ffe7';
          indicator.style.boxShadow = '0 0 8px #00ffe7cc';
        }
      }
      setAvatarStatus('active');

      // --- Always-listening voice assistant with hotword detection ---
      let recognizing = false;
      let recognition;
      let lastTranscript = '';
      let hotwordActive = false;
      if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        recognition.lang = 'en-US';
        recognition.continuous = true;
        recognition.interimResults = false;
        recognition.onstart = function() {
          recognizing = true;
          setAvatarStatus('listening');
          document.getElementById('voice-btn').textContent = 'ðŸ›‘ Stop Listening';
        };
        recognition.onend = function() {
          recognizing = false;
          setAvatarStatus('active');
          document.getElementById('voice-btn').textContent = 'ðŸŽ¤ Start Listening';
          // Auto-restart for always-listening
          if (hotwordActive) recognition.start();
        };
        recognition.onresult = function(event) {
          const transcript = event.results[event.results.length-1][0].transcript.trim();
          lastTranscript = transcript;
          if (hotwordActive) {
            if (/\bhey az\b/i.test(transcript)) {
              setAvatarStatus('listening');
              speakAZ('Yes, Commander?');
            } else if (setAvatarStatus && recognizing) {
              document.getElementById('az-input').value = transcript;
              sendToAZ();
            }
          } else {
            document.getElementById('az-input').value = transcript;
            sendToAZ();
          }
        };
      }
      function toggleVoice() {
        if (!recognition) {
          alert('Voice recognition not supported in this browser.');
          return;
        }
        if (recognizing) {
          hotwordActive = false;
          recognition.stop();
        } else {
          hotwordActive = true;
          recognition.start();
        }
      }
      // Text-to-voice feedback
      function speakAZ(text) {
        if ('speechSynthesis' in window) {
          const utter = new SpeechSynthesisUtterance(text);
          utter.voice = window.speechSynthesis.getVoices().find(v => v.name.toLowerCase().includes('female') || v.name.toLowerCase().includes('en')) || null;
          utter.rate = 1.05;
          window.speechSynthesis.speak(utter);
        }
      }
      // Conversational memory (simple)
      let conversationHistory = [];
      function sendToAZ() {
        const persona = document.getElementById('persona-select').value;
        const input = document.getElementById('az-input').value;
        const display = document.getElementById('timeline-area');
        conversationHistory.push({ role: persona, text: input });
        if (conversationHistory.length > 10) conversationHistory.shift();
        display.textContent = 'Processing...';
        fetch(`/api/chat?q=${encodeURIComponent(input)}&persona=${persona}`)
          .then(r => r.json())
          .then(data => {
            const output = data[persona] || data.output || JSON.stringify(data);
            display.textContent = output;
            speakAZ(output);
          })
          .catch(() => {
            display.textContent = 'Action failed or not implemented.';
          });
      }
    </script>
  </div>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NCC Command Console Dashboard</title>
  <script>
    // Cache-busting version string
    const NCC_VERSION = Date.now();
    // Replace all static asset URLs with ?v=timestamp
    window.addEventListener('DOMContentLoaded', () => {
      // Images
      document.querySelectorAll('img[src], source[src], video[src], audio[src]').forEach(el => {
        if (!el.src.includes('?v=')) el.src += (el.src.includes('?') ? '&' : '?') + 'v=' + NCC_VERSION;
      });
      // Stylesheets
      document.querySelectorAll('link[rel="stylesheet"][href]').forEach(el => {
        if (!el.href.includes('?v=')) el.href += (el.href.includes('?') ? '&' : '?') + 'v=' + NCC_VERSION;
      });
      // Scripts (except this one)
      document.querySelectorAll('script[src]').forEach(el => {
        if (!el.src.includes('?v=') && !el.src.includes('NCC_VERSION')) el.src += (el.src.includes('?') ? '&' : '?') + 'v=' + NCC_VERSION;
      });
    });
  </script>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #0f2027 0%, #2c5364 100%);
      color: #00ffe7;
      margin: 0;
      min-height: 100vh;
      overflow-x: hidden;
    }
    .container {
      max-width: 1100px;
      margin: 48px auto;
      background: rgba(34,36,42,0.7);
      border-radius: 18px;
      padding: 40px 36px 32px 36px;
      box-shadow: 0 8px 32px 0 #00ffe755, 0 1.5px 8px #00ffe733;
      backdrop-filter: blur(12px);
      border: 1.5px solid #00ffe733;
    }
    h1 {
      color: #00ffe7;
      font-size: 2.6em;
      letter-spacing: 2px;
      text-shadow: 0 0 12px #00ffe7cc, 0 2px 8px #000a;
      margin-bottom: 18px;
      text-align: center;
    }
    .card {
      background: rgba(24,26,32,0.85);
      border-radius: 14px;
      padding: 28px 24px 20px 24px;
      margin-bottom: 32px;
      box-shadow: 0 2px 16px #00ffe733, 0 1.5px 8px #00ffe722;
      border: 1.5px solid #00ffe722;
      backdrop-filter: blur(8px);
    }
    .actions {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-bottom: 18px;
      justify-content: center;
    }
    .actions button {
      background: linear-gradient(90deg, #00ffe7 0%, #00bfae 100%);
      color: #181a20;
      border: none;
      border-radius: 8px;
      padding: 12px 22px;
      font-size: 1.08em;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 2px 12px #00ffe733;
      transition: background 0.2s, transform 0.15s, box-shadow 0.2s;
      outline: none;
      letter-spacing: 0.5px;
    }
    .actions button:hover {
      background: linear-gradient(90deg, #00bfae 0%, #00ffe7 100%);
      color: #fff;
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 4px 24px #00ffe799;
    }
    .display-window {
      background: rgba(35,37,44,0.95);
      border-radius: 10px;
      padding: 20px 18px;
      margin-top: 16px;
      min-height: 70px;
      color: #fff;
      font-size: 1.08em;
      box-shadow: 0 1.5px 8px #00ffe733;
      border: 1.5px solid #00ffe722;
      font-family: 'Fira Mono', 'Consolas', monospace;
      word-break: break-word;
    }
    .chat-bots {
      display: flex;
      gap: 20px;
      margin-top: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .chat-bot {
      flex: 1 1 220px;
      background: rgba(35,37,44,0.92);
      border-radius: 10px;
      padding: 16px 14px;
      min-width: 220px;
      box-shadow: 0 1.5px 8px #00ffe733;
      border: 1.5px solid #00ffe722;
      font-family: 'Fira Mono', 'Consolas', monospace;
      color: #00ffe7;
      margin-bottom: 8px;
    }
    input, button {
      font-size: 1em;
      padding: 8px;
      <!DOCTYPE html>
      <html lang="en">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>NCC Command Console Dashboard</title>
        <style>
          body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #2c5364 100%);
            color: #00ffe7;
            margin: 0;
            min-height: 100vh;
            overflow-x: hidden;
          }
          .container {
            max-width: 1100px;
            margin: 48px auto;
            background: rgba(34,36,42,0.7);
            border-radius: 18px;
            padding: 40px 36px 32px 36px;
            box-shadow: 0 8px 32px 0 #00ffe755, 0 1.5px 8px #00ffe733;
            backdrop-filter: blur(12px);
            border: 1.5px solid #00ffe733;
          }
          h1 {
            color: #00ffe7;
            font-size: 2.6em;
            letter-spacing: 2px;
            text-shadow: 0 0 12px #00ffe7cc, 0 2px 8px #000a;
            margin-bottom: 18px;
            text-align: center;
          }
          .card {
            background: rgba(24,26,32,0.85);
            border-radius: 14px;
            padding: 28px 24px 20px 24px;
            margin-bottom: 32px;
            box-shadow: 0 2px 16px #00ffe733, 0 1.5px 8px #00ffe722;
            border: 1.5px solid #00ffe722;
            backdrop-filter: blur(8px);
          }
          .actions {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 18px;
            justify-content: center;
          }
          .actions button {
            background: linear-gradient(90deg, #00ffe7 0%, #00bfae 100%);
            color: #181a20;
            border: none;
            border-radius: 8px;
            padding: 12px 22px;
            font-size: 1.08em;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 12px #00ffe733;
            transition: background 0.2s, transform 0.15s, box-shadow 0.2s;
            outline: none;
            letter-spacing: 0.5px;
          }
          .actions button:hover {
            background: linear-gradient(90deg, #00bfae 0%, #00ffe7 100%);
            color: #fff;
            transform: translateY(-2px) scale(1.04);
            box-shadow: 0 4px 24px #00ffe799;
          }
          .display-window {
            background: rgba(35,37,44,0.95);
            border-radius: 10px;
            padding: 20px 18px;
            margin-top: 16px;
            min-height: 70px;
            color: #fff;
            font-size: 1.08em;
            box-shadow: 0 1.5px 8px #00ffe733;
            border: 1.5px solid #00ffe722;
            font-family: 'Fira Mono', 'Consolas', monospace;
            word-break: break-word;
          }
          .chat-bots {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            flex-wrap: wrap;
            justify-content: center;
          }
          .chat-bot {
            flex: 1 1 220px;
            background: rgba(35,37,44,0.92);
            border-radius: 10px;
            padding: 16px 14px;
            min-width: 220px;
            box-shadow: 0 1.5px 8px #00ffe733;
            border: 1.5px solid #00ffe722;
            font-family: 'Fira Mono', 'Consolas', monospace;
            color: #00ffe7;
            margin-bottom: 8px;
          }
          input, button {
            font-size: 1em;
            padding: 8px;
            border-radius: 4px;
            border: none;
          }
          #chat-input {
            width: 60%;
            background: rgba(24,26,32,0.85);
            color: #00ffe7;
            border: 1.5px solid #00ffe7;
            margin-right: 8px;
            font-family: 'Fira Mono', 'Consolas', monospace;
            outline: none;
            transition: border 0.2s, box-shadow 0.2s;
          }
          #chat-input:focus {
            border: 1.5px solid #00bfae;
            box-shadow: 0 0 8px #00ffe7cc;
          }
          #chat-form button {
            background: linear-gradient(90deg, #00ffe7 0%, #00bfae 100%);
            color: #181a20;
            font-weight: 600;
            border-radius: 8px;
            padding: 10px 20px;
            margin-left: 8px;
            box-shadow: 0 2px 12px #00ffe733;
            transition: background 0.2s, transform 0.15s, box-shadow 0.2s;
          }
          #chat-form button:hover {
            background: linear-gradient(90deg, #00bfae 0%, #00ffe7 100%);
            color: #fff;
            transform: translateY(-2px) scale(1.04);
            box-shadow: 0 4px 24px #00ffe799;
          }
          @media (max-width: 700px) {
            .container { padding: 12px 2vw; }
            .actions { gap: 8px; }
            .card { padding: 12px 2vw; }
            h1 { font-size: 1.5em; }
            .chat-bots { flex-direction: column; gap: 8px; }
          }
        </style>
        <script>
          // Cache-busting version string
          const NCC_VERSION = Date.now();
          // Replace all static asset URLs with ?v=timestamp
          window.addEventListener('DOMContentLoaded', () => {
            // Images
            document.querySelectorAll('img[src], source[src], video[src], audio[src]').forEach(el => {
              if (!el.src.includes('?v=')) el.src += (el.src.includes('?') ? '&' : '?') + 'v=' + NCC_VERSION;
            });
            // Stylesheets
            document.querySelectorAll('link[rel="stylesheet"][href]').forEach(el => {
              if (!el.href.includes('?v=')) el.href += (el.href.includes('?') ? '&' : '?') + 'v=' + NCC_VERSION;
            });
            // Scripts (except this one)
            document.querySelectorAll('script[src]').forEach(el => {
              if (!el.src.includes('?v=') && !el.src.includes('NCC_VERSION')) el.src += (el.src.includes('?') ? '&' : '?') + 'v=' + NCC_VERSION;
            });
          });
        </script>
      </head>
      <body>
        <div class="container">
          <!-- Onboarding/Help Tooltip -->
          <div id="onboarding-tip" style="background:#00ffe7; color:#181a20; border-radius:10px; padding:12px 18px; margin-bottom:18px; font-size:1.08em; font-weight:500; box-shadow:0 2px 12px #00ffe733;">
            Welcome! Use the persona selector to command AZ PRIME or other assistants. Integrations, analytics, and plugin support are now available. Hover over any section for help.
          </div>
          <div style="display:flex;flex-direction:row;align-items:center;justify-content:space-between;margin-bottom:10px;">
            <h1 style="margin:0;">NCC Command Console Dashboard</h1>
            <div id="azprime-avatar">
              <div id="az-avatar-outer" style="width:96px;height:120px;display:flex;align-items:center;justify-content:center;position:relative;">
                <div id="az-avatar-glow" style="width:96px;height:120px;border-radius:40px;background:radial-gradient(circle,#00ffe7 0%,#00bfae 80%,transparent 100%);box-shadow:0 0 32px 12px #00ffe7cc;transition:box-shadow 0.3s,background 0.3s;position:absolute;z-index:1;"></div>
                <svg id="az-svg-avatar" width="80" height="110" viewBox="0 0 80 110" style="z-index:2;position:relative;">
                  <!-- Shoulders -->
                  <ellipse id="az-shoulders" cx="40" cy="100" rx="32" ry="14" fill="#1a2a3a" />
                  <!-- Head -->
                  <ellipse id="az-head" cx="40" cy="54" rx="28" ry="34" fill="#00ffe7" stroke="#00bfae" stroke-width="2" />
                  <!-- Eyes -->
                  <ellipse cx="30" cy="54" rx="4" ry="6" fill="#222" />
                  <ellipse cx="50" cy="54" rx="4" ry="6" fill="#222" />
                  <!-- Mouth -->
                  <ellipse id="az-svg-mouth" cx="40" cy="74" rx="8" ry="3" fill="#181a20" />
                </svg>
              </div>
            </div>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:18px;">
            <div style="font-size:1.1em;font-weight:600;">Skin:
              <select id="skin-select" onchange="setSkin(this.value)">
                <option value="0">Neon Glass</option>
                <option value="1">Cyber Night</option>
                <option value="2">Classic Dark</option>
                <option value="3">Solarized</option>
                <option value="4">Matrix</option>
                <option value="5">Aurora</option>
                <option value="6">Terminal Green</option>
                <option value="7">Royal Blue</option>
                <option value="8">Sunset</option>
              </select>
            </div>
            <div style="font-size:1.1em;font-weight:600;">Persona:
              <select id="persona-select">
                <option value="azprime">AZ PRIME</option>
                <option value="emp">EMP (Media)</option>
                <option value="copilot">Copilot</option>
                <option value="chatgpt">ChatGPT</option>
              </select>
            </div>
          </div>
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:18px;">
            <input type="text" id="az-input" placeholder="Speak to AZ PRIME..." style="flex:1;font-size:1.1em;padding:8px 12px;border-radius:8px;border:1.5px solid #00ffe7;outline:none;" autocomplete="off" />
            <button onclick="sendToAZ()" style="font-size:1.1em;padding:8px 18px;border-radius:8px;background:linear-gradient(90deg,#00ffe7 0%,#00bfae 100%);color:#181a20;font-weight:600;border:none;">Send</button>
            <button id="voice-btn" onclick="toggleVoice()" style="font-size:1.1em;padding:8px 18px;border-radius:8px;background:#181a20;color:#00ffe7;font-weight:600;border:2px solid #00ffe7;margin-left:8px;" title="Start/Stop Voice Input">ðŸŽ¤ Start Listening</button>
          </div>
          <div class="display-window" id="display-window" style="margin-top:12px;">Awaiting your command...</div>
          <!-- Additional advanced sections (Integrations, Analytics, User Management, Plugins, etc.) can be restored here as needed -->
        </div>
        <script>
          // --- Voice Recognition (Speech-to-Text) ---
          let recognizing = false;
          let recognition;
          if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'en-US';
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.onstart = function() {
              recognizing = true;
              document.getElementById('voice-btn').textContent = 'ðŸ›‘ Stop Listening';
            };
            recognition.onend = function() {
              recognizing = false;
              document.getElementById('voice-btn').textContent = 'ðŸŽ¤ Start Listening';
            };
            recognition.onresult = function(event) {
              const transcript = event.results[0][0].transcript;
              document.getElementById('az-input').value = transcript;
              sendToAZ();
            };
          }
          function toggleVoice() {
            if (!recognition) {
              alert('Voice recognition not supported in this browser.');
              return;
            }
            if (recognizing) {
              recognition.stop();
            } else {
              recognition.start();
            }
          }
          function sendToAZ() {
            const persona = document.getElementById('persona-select').value;
            const input = document.getElementById('az-input').value;
            const display = document.getElementById('display-window');
            display.textContent = 'Processing...';
            fetch(`/api/chat?q=${encodeURIComponent(input)}&persona=${persona}`)
              .then(r => r.json())
              .then(data => {
                const output = data[persona] || data.output || JSON.stringify(data);
                display.textContent = output;
              })
              .catch(() => {
                display.textContent = 'Action failed or not implemented.';
              });
          }
          // Skins
          const skins = [
            // Neon Glass
            {
              body: 'linear-gradient(135deg, #0f2027 0%, #2c5364 100%)',
              accent: '#00ffe7',
              card: 'rgba(24,26,32,0.85)',
              display: 'rgba(35,37,44,0.95)',
              button: 'linear-gradient(90deg, #00ffe7 0%, #00bfae 100%)',
              buttonText: '#181a20',
            },
            // Cyber Night
            {
              body: 'linear-gradient(120deg, #232526 0%, #414345 100%)',
              accent: '#ff00cc',
              card: 'rgba(30,30,40,0.92)',
              display: 'rgba(40,40,60,0.98)',
              button: 'linear-gradient(90deg, #ff00cc 0%, #333399 100%)',
              buttonText: '#fff',
            },
            // Classic Dark
            {
              body: '#181a20',
              accent: '#00ffe7',
              card: '#23252c',
              display: '#23252c',
              button: '#00ffe7',
              buttonText: '#181a20',
            },
            // Solarized
            {
              body: 'linear-gradient(120deg, #002b36 0%, #073642 100%)',
              accent: '#b58900',
              card: '#073642',
              display: '#002b36',
              button: '#b58900',
              buttonText: '#002b36',
            },
            // Matrix
            {
              body: '#000',
              accent: '#00ff41',
              card: '#001a00',
              display: '#002200',
              button: '#00ff41',
              buttonText: '#001a00',
            },
            // Aurora
            {
              body: 'linear-gradient(120deg, #0f2027 0%, #2c5364 50%, #ffaf7b 100%)',
              accent: '#ffaf7b',
              card: 'rgba(34,36,42,0.8)',
              display: 'rgba(44,46,52,0.95)',
              button: 'linear-gradient(90deg, #ffaf7b 0%, #00ffe7 100%)',
              buttonText: '#181a20',
            },
            // Terminal Green
            {
              body: '#111',
              accent: '#00ff00',
              card: '#181a20',
              display: '#181a20',
              button: '#00ff00',
              buttonText: '#111',
            },
            // Royal Blue
            {
              body: 'linear-gradient(120deg, #141e30 0%, #243b55 100%)',
              accent: '#00c6ff',
              card: '#243b55',
              display: '#141e30',
              button: '#00c6ff',
              buttonText: '#243b55',
            },
            // Sunset
            {
              body: 'linear-gradient(120deg, #ff512f 0%, #dd2476 100%)',
              accent: '#fff',
              card: 'rgba(255,81,47,0.15)',
              display: 'rgba(221,36,118,0.15)',
              button: 'linear-gradient(90deg, #ff512f 0%, #dd2476 100%)',
              buttonText: '#fff',
            },
            // Minimalist
            {
              body: '#fff',
              accent: '#222',
              card: '#f4f4f4',
              display: '#eaeaea',
              button: '#222',
              buttonText: '#fff',
            },
          ];
          function setSkin(idx) {
            idx = parseInt(idx);
            const skin = skins[idx];
            document.body.style.background = skin.body;
            document.body.style.color = skin.accent;
            document.querySelectorAll('.card').forEach(e => {
              e.style.background = skin.card;
              e.style.borderColor = skin.accent + '55';
            });
            document.querySelectorAll('.display-window').forEach(e => {
              e.style.background = skin.display;
              e.style.borderColor = skin.accent + '55';
              e.style.color = skin.buttonText;
            });
            document.querySelectorAll('.actions button, #chat-form button').forEach(e => {
              e.style.background = skin.button;
              e.style.color = skin.buttonText;
            });
            document.querySelectorAll('.chat-bot').forEach(e => {
              e.style.background = skin.display;
              e.style.borderColor = skin.accent + '55';
              e.style.color = skin.accent;
            });
          }
          setSkin(0);
          document.getElementById('skin-select').value = 0;
        </script>
      </body>
      </html>
                  <!-- Integrations Section -->
